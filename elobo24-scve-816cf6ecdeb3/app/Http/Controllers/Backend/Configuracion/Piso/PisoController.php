<?php

namespace App\Http\Controllers\Backend\Configuracion\Piso;

use Illuminate\Http\Request;

use App\Http\Requests;
use App\Http\Controllers\Controller;

use App\Models\Configuracion\Pisos;
use App\Http\Requests\Backend\Configuracion\Piso\PisoCreateRequest;
use App\Http\Requests\Backend\Configuracion\Piso\PisoUpdateRequest;
use Session;
use DB;
use Illuminate\Database\Connection;
use Yajra\Datatables\Facades\Datatables;
use Input;
use Response;

class PisoController extends Controller
{
  public function getIndex(Request $request)
  {
    $pisos = Pisos::select('t_pisos.*')
    ->get();

    return view('backend.configuracion.pisos.index')
    ->with('pisos', $pisos);
  }

  public function create()
  {
    return View('backend.configuracion.pisos.create');
  }

  public function store(PisoCreateRequest $request)
  {
    // Piso
    $piso = new Pisos();
    $piso->nombre = $request->input('nombre');
    $piso->estatus = $request->input('estatus');
    $result = $piso->save();

    notify()->flash('Piso Registrado', 'success', [
      'timer' => 3000,
      'text' => ''
    ]);

    return redirect()->route('Piso');

  }

  public function show($id)
  {
    $piso = Pisos::FindOrFail($id);
    return view('backend.configuracion.pisos.show')->with('piso', $piso);
  }

  public function edit($id)
  {
    $piso = Pisos::find($id);

    return view('backend.configuracion.pisos.edit')->with('piso', $piso);
  }

  public function update(PisoUpdateRequest $request, $id)
  {

    $piso = Pisos::FindOrFail($id);
    $input = $request->all();  /*Guardamos toda la informaciÃ³n que se esta enviando*/
    $result = $piso->fill($input)->save(); /*Se guarda la informaciÃ³n*/

    notify()->flash('Piso Actualizado', 'success', [
      'timer' => 3000,
      'text' => ''
    ]);

    return redirect()->route('Piso');

  }

  public function destroy($id)
  {
    $piso = Pisos::FindOrFail($id);
    $result = $piso->delete();

    if ($result)
    {
      return response()->json(['success'=>'true']);
    }
    else
    {
      return response()->json(['success'=> 'false']);
    }
  }
}
