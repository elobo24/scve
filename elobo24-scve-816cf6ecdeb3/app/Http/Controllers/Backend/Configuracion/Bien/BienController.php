<?php

namespace App\Http\Controllers\Backend\Configuracion\Bien;

use Illuminate\Http\Request;

use App\Http\Requests;
use App\Http\Controllers\Controller;

use App\Models\Configuracion\Bienes;
use App\Http\Requests\Backend\Configuracion\Bien\BienCreateRequest;
use App\Http\Requests\Backend\Configuracion\Bien\BienUpdateRequest;
use Session;
use DB;
use Illuminate\Database\Connection;
use Yajra\Datatables\Facades\Datatables;
use Input;
use Response;

class BienController extends Controller
{
  public function getIndex(Request $request)
  {
    $bienes = Bienes::select('t_bienes.*')
    ->get();

    return view('backend.configuracion.bienes.index')
    ->with('bienes', $bienes);
  }

  public function create()
  {
    return View('backend.configuracion.bienes.create');
  }

  public function store(BienCreateRequest $request)
  {
    // Bien
    $bien = new Bienes();
    $bien->nombre = $request->input('nombre');
    $bien->estatus = $request->input('estatus');
    $result = $bien->save();

    notify()->flash('Equipo 贸 Bien Registrado', 'success', [
      'timer' => 3000,
      'text' => ''
    ]);

    return redirect()->route('EquiposBienes');
  }

  public function show($id)
  {
    $bien = Bienes::FindOrFail($id);
    return view('backend.configuracion.bienes.show')->with('bien', $bien);
  }

  public function edit($id)
  {
    $bien = Bienes::find($id);

    return view('backend.configuracion.bienes.edit')->with('bien', $bien);
  }

  public function update(BienUpdateRequest $request, $id)
  {

    $bien = Bienes::FindOrFail($id);
    $input = $request->all();  /*Guardamos toda la informaci贸n que se esta enviando*/
    $result = $bien->fill($input)->save(); /*Se guarda la informaci贸n*/

    notify()->flash('Equipo 贸 Bien Actualizado', 'success', [
      'timer' => 3000,
      'text' => ''
    ]);

    return redirect()->route('EquiposBienes');
  }

  public function destroy($id)
  {
    $bien = Bienes::FindOrFail($id);
    $result = $bien->delete();

    if ($result)
    {
      return response()->json(['success'=>'true']);
    }
    else
    {
      return response()->json(['success'=> 'false']);
    }
  }
}
