<?php

namespace App\Http\Controllers\Backend;

use App\Http\Controllers\Controller;
use App\Models\Configuracion\Empresas;
use App\Models\Control_Visitas\Visitantes;
use App\Models\Control_Visitas\Visitas;
use App\Models\Configuracion\Bienes;
use App\Models\Control_Visitas\Equipajes;
use Session;
use DB;
use Illuminate\Database\Connection;
use Yajra\Datatables\Facades\Datatables;
use Jenssegers\Date\Date;
use Input;

/**
 * Class DashboardController
 * @package App\Http\Controllers\Backend
 */
class EgresospController extends Controller
{
    /**
     * @return \Illuminate\View\View
     */
    public function show($id)
    {
      $EgresosPersonas = Visitantes::select('t_visitantes.cedula','t_visitantes.nombre','t_visitantes.apellido','t_visitantes.foto','t_visitas.empresa_origen',DB::raw("(t_empresas.nombre) AS empresa_destino"),'t_visitas.entrada','t_visitas.salida')
      ->Join('t_visitas','t_visitas.visitante_id','=','t_visitantes.id')
      ->Join('t_empresas','t_visitas.empresa_id','=','t_empresas.id')
      ->where('t_visitas.id','=', $id)
      ->get()
      ->first();

      $EgresosEquipos = Equipajes::select('t_equipajes.marca','t_equipajes.serial','t_equipajes.descripcion','t_equipajes.hora_entrada','t_equipajes.hora_salida','t_bienes.nombre')
      ->join('t_bienes','t_equipajes.bien_id','=','t_bienes.id')
      ->where('t_equipajes.visita_id','=', $id)
      ->get();

      return view('backend.dashboard.egresos.personas.show')
      ->with('EgresosPersonas',$EgresosPersonas)
      ->with('EgresosEquipos', $EgresosEquipos);
    }
}
