@extends ('backend.layouts.master')
@section('page-header')
  <h1><i class="fa fa-users fa-lg"></i> Activos</h1>
  <ol class="breadcrumb">
    <li><a href="#"><i class="fa fa-lock"></i> Seguridad</a></li>
    <li> Usuarios</li>
    <li> Activos</li>
    <li class="active"> Editar</li>
  </ol>
@stop
@section('content')
    {{ Form::model($user, ['route' => ['scve.seguridad.user.update', $user], 'class' => 'form-horizontal', 'role' => 'form', 'method' => 'PATCH', 'id'=>'form-edit']) }}
        <div class="box box-warning">
            <div class="box-header with-border">
              <!--codigo gui MOD-SEGU-1.2---->
              <input type="hidden" name="codigo_gui" value="MOD-SEGU-1.2.3" id="codigo_gui">
                <h3 class="box-title">Editar Usuarios</h3>
            </div><!-- /.box-header -->
            <div class="box-body">
              <div class="form-group">
                <div class="col-sm-6 col-sm-offset-3">
                  @include('includes.partials.messages')
                </div>
              </div>
              <div class="form-group">
                <div class="col-sm-6 col-sm-offset-3">
                  <span id="helpBlock" class="help-block">Los campos marcados con un asterisco (*) son obligatorios.</span>
                </div>
              </div>
                <div class="form-group">
                    {{ Form::label('name', 'Nombre(*)', ['class' => 'col-lg-3 control-label']) }}
                    <div class="col-lg-6">
                        {{ Form::text('name', null, ['class' => 'form-control', 'placeholder' => 'Nombre']) }}
                    </div><!--col-lg-10-->
                </div><!--form control-->
                <div class="form-group">
                    {{ Form::label('email', 'Usuario(*)', ['class' => 'col-lg-3 control-label']) }}
                    <div class="col-lg-6">
                        {{ Form::text('email', null, ['class' => 'form-control', 'placeholder' => 'Usuario']) }}
                    </div><!--col-lg-10-->
                </div><!--form control-->
                @if ($user->id != 1)
                    <div class="form-group">
                        {{ Form::label('status', 'Activo', ['class' => 'col-lg-3 control-label']) }}
                        <div class="col-lg-1">
                            {{ Form::checkbox('status', '1', $user->status == 1) }}
                        </div><!--col-lg-1-->
                    </div><!--form control-->
                    <input type="hidden" name="confirmed" value="true">
                    <div class="form-group">
                        {{ Form::label('status', 'Roles Asociados(*)', ['class' => 'col-lg-3 control-label']) }}
                        <div class="col-lg-3">
                            @if (count($roles) > 0)
                                @foreach($roles as $role)
                                    <input type="checkbox" value="{{$role->id}}" name="assignees_roles[]" {{in_array($role->id, $user_roles) ? 'checked' : ''}} id="role-{{$role->id}}" /> <label for="role-{{$role->id}}">{{ $role->name }}</label>
                                        <a href="#" data-role="role_{{$role->id}}" class="show-permissions small">
                                            (
                                                <span class="show-text">Mostrar</span>
                                                <span class="hide-text hidden">Ocultar</span>
                                                Permisos
                                            )
                                        </a>
                                    <br/>
                                    <div class="permission-list hidden" data-role="role_{{$role->id}}">
                                        @if ($role->all)
                                            Todos los Permisos asignados.<br/><br/>
                                        @else
                                            @if (count($role->permissions) > 0)
                                                <blockquote class="small">{{--
                                            --}}@foreach ($role->permissions as $perm){{--
                                            --}}{{$perm->display_name}}<br/>
                                                    @endforeach
                                                </blockquote>
                                            @else
                                                Sin Permisos asignados.<br/><br/>
                                            @endif
                                        @endif
                                    </div><!--permission list-->
                                @endforeach
                            @else
                                No hay Roles disponibles.
                            @endif
                        </div><!--col-lg-3-->
                    </div><!--form control-->
                @endif
                <div class="form-group">
                  <div class="col-sm-6 col-sm-offset-3">
                    <div class="pull-right">
                      {{ Form::submit('Editar', ['class' => 'btn btn-success btn-sm','title'=>'Editar']) }}
                      {{ link_to_route('scve.seguridad.user.index', 'Cancelar', [], ['class' => 'btn btn-danger btn-sm','title'=>'Cancelar']) }}
                    </div>
                  </div>
                </div>
                <div class="clearfix"></div>
            </div><!-- /.box-body -->
          </div><!--box-->
        @if ($user->id == 1)
            {{ Form::hidden('status', 1) }}
            {{ Form::hidden('confirmed', 1) }}
            {{ Form::hidden('assignees_roles[]', 1) }}
        @endif
    {{ Form::close() }}
@stop
@section('after-scripts-end')
    {{ Html::script('js/backend/access/users/script.js') }}
@stop
